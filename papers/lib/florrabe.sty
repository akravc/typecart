% ifnonempty{a}{b} = if (a == empty) empty else b
\newcommand{\ifnonempty}[3][]{\def\@empty{}\def\@test{#2}\ifx\@test\@empty#1\else#3\fi}
% fold{a}{b1,...,bn} = b1 a ... a bn
\newcommand{\fold}[2]{\def\@tmpop{\relax}\@for\@I:=#2\do{\@tmpop\@I\def\@tmpop{#1}}}

% symbols
\newcommand{\nin}{\not\in}
\newcommand{\sm}{\setminus}
\newcommand{\es}{\varnothing}
\newcommand{\pwr}{\mathcal{P}}
\newcommand{\rewrites}{\rightsquigarrow}

% style shortcuts
\newcommand{\ov}[1]{\overline{#1}}
\newcommand{\und}[1]{\underline{#1}}


% CFGs
\newcommand{\tb}{\hspace*{.5cm}}

\newenvironment{grammar}{\[\begin{array}{l@{\tb\bbc\tb}l@{\tb}l}}{\end{array}\]}
\newcommand{\bnf}[1]{#1}
\newcommand{\bbc}{\bnf{::=}}
\newcommand{\bnfalt}{\ensuremath{\;\bnf{|}\;}}
\providecommand{\alt}{\ensuremath{\;\bnf{|}\;}} % already used by beamer
\newcommand{\opt}[1]{\bnf{[}#1\bnf{]}}
\newcommand{\bopt}[1]{\opt{\bnfbracket{#1}}}
\newcommand{\bnfbracket}[1]{\bnf{(}#1\bnf{)}}
\newcommand{\rep}[1]{#1^{\bnf{\ast}}}
\newcommand{\brep}[1]{\rep{\bnfbracket{#1}}}
\newcommand{\bnfchoice}[1]{\bnf{[}#1\bnf{]}}
\newcommand{\bnfnegchoice}[1]{\bnf{[\caret}#1\bnf{]}}

\newenvironment{commgrammar}{\[\begin{array}{l@{\;}c@{\;}l@{\tb}l}}{\end{array}\]}
\newcommand{\gcomment}[1]{\multicolumn{4}{l}{\rule{0pt}{4ex}\fbox{#1}\vspace{.3em}}}
\newcommand{\gprod}[3]{#1 & \bbc & #2 & \text{#3}}
\newcommand{\galtprod}[2]{ & \bnf{|} & #1 & \text{#2}}

% defining names with consistent styles
% \cn{int} for the name "int", in or outside math mode
\providecommand{\cn}[1]{\ensuremath{\mathtt{#1}}\ifmmode\else\xspace\fi}
% \makecn{int} to make \int a name
\newcommand{\makecn}[1]{\@ifundefined{#1}{\makecnF{#1}}{\PackageError{basics}{#1 already defined}{use makecnF to force override}}}
% like makecn but forcese overriding existing names
\newcommand{\makecnF}[1]{\expandafter\gdef\csname#1\endcsname{\cn{#1}}}


